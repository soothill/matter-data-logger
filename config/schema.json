{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/soothill/matter-data-logger/config/schema.json",
  "title": "Matter Power Data Logger Configuration",
  "description": "Configuration schema for the Matter Power Data Logger application",
  "type": "object",
  "required": ["influxdb", "matter", "logging"],
  "properties": {
    "influxdb": {
      "type": "object",
      "description": "InfluxDB connection configuration",
      "required": ["url", "token", "organization", "bucket"],
      "properties": {
        "url": {
          "type": "string",
          "format": "uri",
          "description": "InfluxDB server URL (http:// or https://)",
          "examples": [
            "http://localhost:8086",
            "https://influxdb.example.com"
          ],
          "pattern": "^https?://"
        },
        "token": {
          "type": "string",
          "description": "InfluxDB authentication token",
          "minLength": 8,
          "examples": ["your-influxdb-token-here"]
        },
        "organization": {
          "type": "string",
          "description": "InfluxDB organization name",
          "minLength": 1,
          "examples": ["my-org"]
        },
        "bucket": {
          "type": "string",
          "description": "InfluxDB bucket name for storing power data",
          "minLength": 1,
          "examples": ["power-data"]
        }
      }
    },
    "matter": {
      "type": "object",
      "description": "Matter device discovery and monitoring configuration",
      "required": ["discovery_interval", "poll_interval"],
      "properties": {
        "discovery_interval": {
          "type": "string",
          "description": "How often to scan for new devices (Go duration format)",
          "pattern": "^[0-9]+(ns|us|µs|ms|s|m|h)$",
          "examples": ["5m", "10m", "1h"],
          "default": "5m"
        },
        "poll_interval": {
          "type": "string",
          "description": "How often to read power from each device (Go duration format)",
          "pattern": "^[0-9]+(ns|us|µs|ms|s|m|h)$",
          "examples": ["30s", "1m", "5m"],
          "default": "30s"
        },
        "service_type": {
          "type": "string",
          "description": "mDNS service type to discover",
          "default": "_matter._tcp",
          "examples": ["_matter._tcp"]
        },
        "domain": {
          "type": "string",
          "description": "mDNS domain to search",
          "default": "local.",
          "examples": ["local."]
        },
        "readings_channel_size": {
          "type": "integer",
          "description": "Size of power readings channel buffer",
          "minimum": 10,
          "maximum": 10000,
          "default": 1000,
          "examples": [100, 1000, 5000]
        }
      }
    },
    "logging": {
      "type": "object",
      "description": "Logging configuration",
      "required": ["level"],
      "properties": {
        "level": {
          "type": "string",
          "description": "Log level for application output",
          "enum": ["debug", "info", "warn", "error", "fatal", "panic"],
          "default": "info",
          "examples": ["info", "debug", "warn"]
        }
      }
    },
    "notifications": {
      "type": "object",
      "description": "Notification configuration (optional)",
      "properties": {
        "slack_webhook_url": {
          "type": "string",
          "format": "uri",
          "description": "Slack webhook URL for sending alerts",
          "pattern": "^https://hooks\\.slack\\.com/services/",
          "examples": ["https://hooks.slack.com/services/YOUR/WEBHOOK/URL"]
        }
      }
    },
    "cache": {
      "type": "object",
      "description": "Local cache configuration for offline resilience",
      "properties": {
        "directory": {
          "type": "string",
          "description": "Directory path for storing cached data",
          "default": "./cache",
          "examples": ["./cache", "/var/cache/matter-data-logger"]
        },
        "max_size": {
          "type": "integer",
          "description": "Maximum cache size in bytes",
          "minimum": 1048576,
          "maximum": 10737418240,
          "default": 104857600,
          "examples": [104857600, 1073741824]
        },
        "max_age": {
          "type": "string",
          "description": "Maximum age of cached data (Go duration format)",
          "pattern": "^[0-9]+(ns|us|µs|ms|s|m|h)$",
          "default": "24h",
          "examples": ["24h", "48h", "7d"]
        }
      }
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "influxdb": {
        "url": "http://localhost:8086",
        "token": "your-influxdb-token-here",
        "organization": "my-org",
        "bucket": "power-data"
      },
      "matter": {
        "discovery_interval": "5m",
        "poll_interval": "30s",
        "service_type": "_matter._tcp",
        "domain": "local.",
        "readings_channel_size": 1000
      },
      "logging": {
        "level": "info"
      },
      "notifications": {
        "slack_webhook_url": "https://hooks.slack.com/services/YOUR/WEBHOOK/URL"
      },
      "cache": {
        "directory": "./cache",
        "max_size": 104857600,
        "max_age": "24h"
      }
    }
  ],
  "definitions": {
    "duration": {
      "type": "string",
      "description": "Go duration format (e.g., 1h30m, 5s, 100ms)",
      "pattern": "^[0-9]+(ns|us|µs|ms|s|m|h)$"
    },
    "url": {
      "type": "string",
      "format": "uri",
      "pattern": "^https?://"
    }
  }
}
